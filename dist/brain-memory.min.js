let BrainMemory=function(t){"use strict";function e(t=!1){return t}function r(){return""}function i(t){return"string"==typeof t||t instanceof String}function n(t){return"isArray"in Array||Array.isArray?Array.isArray(t):"object"==typeof t&&t instanceof Array}function s(t){return!n(t)}function a(t){return null==t}function o(t){return!a(t)}function l(t){return t instanceof Object&&"object"==typeof t}function f(t,e=[Object]){s(e)&&(e=[e]);let r=!0;return e.forEach(e=>{t instanceof e||(r=!1)}),r}function c(t,e){if(t.startsWith(e+"-"));else if(void 0!==e)return e+"-"+t;return t}function h(t){return t.endsWith("-")?t:t.concat("-")}function u(t){return"string"==typeof t&&(t=t.trim()),0!=t&&"false"!==t&&"0"!==t&&(1==t||"true"===t||"1"===t||t)}function p(t,e){return!!(o(t)&&l(t)&&o(e)&&i(e))&&o(t[e])}class y{constructor(t,r=e()){var i;if(!((i=t)===localStorage||i===sessionStorage))throw Error("Invalid memory instance: must be localStorage or sessionStorage.");r!==e()&&this.prefix(r),this.instance=t}prefix(t){if(i(t))return this._prefix=t,this;throw Error('Invalid argument type: "prefix" parameter must be a string.')}hasPrefix(){var t,e;return!(!1===(e=u(e=t=this._prefix))&&"boolean"==typeof e||e instanceof Boolean||a(t))}hasRecord(t){let e=!1;t=c(t,this._prefix),p(this.instance,"getItem")&&(e=o(this.instance.getItem(t)));try{e=t in this.instance}catch{var r,i;e=(r=this.instance,i=t,Object.keys(r).includes(i))}finally{return e}}record(t,r,n=e(!0)){this.hasPrefix()&&(t=c(t,this._prefix));let s,a=0;if(function t(e){var r;if(!i(r=e))throw Error('Invalid argument type: "key" parameter must be a string.');if(String.prototype.indexOf)return -1!=e.indexOf(".");{let n=!1;for(let s=0;s<e.length;s++)if("."==e[s]){n=!0;break}return n}}(t)&&(t=(s=t.split("."))[0],Array.prototype.shift?s.shift():a=1),o(s)){if(n||!this.hasRecord(t)){let f=s.reverse();for(let h=a;h<f.length&&""!=f[h];h++){let u=f[h],y={};y[u]=r,r=y}}else{let g=this.recallOne(t),m=g;for(let x=a;x<s.length-1&&""!=s[x];x++)m=m[s[x]];m[s[s.length-1]]=r,r=g}}return l(r)&&(r=JSON.stringify(r)),p(this.instance,"setItem")?this.instance.setItem(t,r):this.instance[t]=r,this}update(t,e){return this.record(t,e,!1)}recallOne(t,r=e(),n=e()){n=u(n),this.hasPrefix()&&(t=c(t,this._prefix));let s;if(!this.hasRecord(t))return n&&this.record(t,r),r;var a,f="getItem";s=o(a=this.instance)&&l(a)&&o(a.prototype)&&o(f)&&i(f)&&o(a.prototype[f])?this.instance.getItem(t):this.instance[t];try{s=JSON.parse(s)}finally{return s}}recall(t,r=e(),i=e()){if(i=u(i),s(t))return this.recallOne(t,r,i);let a={};return t.forEach(t=>{let s=r[t]??e(),o=n(i)?i.includes(t):i;a[t]=this.recallOne(t,s,o)}),a.get=function(t){return this[t]??null},r!==e()&&(a.recordDefaults=(function(t=e()){t==e()?t=Object.entries(a).filter(t=>"function"!=typeof t[1]).map(t=>t[0]):s(t)&&0==(t=[t]).length&&Object.entries(a).filter(t=>"function"!=typeof t[1]).map(t=>t[0]),t.forEach(t=>this.record(t,a.get(t)))}).bind(this)),a}recallMany=function(t,r=e(),i=e()){return this.recall(t,r,i)};recallExcept=function(t,r=e(),i=e()){let n=Object.keys(this.instance);this.hasPrefix()&&(n=n.filter(t=>t.startsWith(h(this._prefix)).map(t=>{var e,r;return e=t,r=this._prefix,e.replace(h(r),"")}))),s(t)&&(t=[t]);let a=n.filter(e=>!t.includes(e));return this.recall(a,r,i)};recallAll(){let t=Object.keys(this.instance);return this.hasPrefix()&&(t=t.filter(t=>t.startsWith(this._prefix+"-")).map(t=>t.replace(this._prefix+"-",""))),this.recall(t)}forget(t=e()){return s(t)&&(t=[t]),t.forEach(t=>{this.hasPrefix()&&(t=c(t,this._prefix)),t!=e()&&this.instance.removeItem(t)}),!0}forgetExcept(t){s(t)&&(t=[t]);let e=Object.keys(this.instance);this.hasPrefix()&&(e=e.filter(t=>t.startsWith(this._prefix+"-")).map(t=>t.replace(this._prefix+"-","")));let r=e.filter(e=>!t.includes(e));return this.forget(r)}forgetAll(t=!0){if(!0===t){if(this.hasPrefix()){let e=Object.keys(this.instance).filter(t=>t.startsWith(this._prefix+"-")).map(t=>t.replace(this._prefix+"-",""));this.forget(e)}else this.instance.clear();return!0}return!1}}class g{static permanent=function(e){if(!p(t,"localStorage"))throw Error("Your browser does not support local storage. Unfortunately, this library relies on local storage to function correctly. Please consider using a different browser or enabling local storage in your current browser");return new y(localStorage,e)};static temp=function(e){if(!p(t,"sessionStorage"))throw Error("Your browser does not support session storage. Unfortunately, this library relies on local storage to function correctly. Please consider using a different browser or enabling session storage in your current browser");return new y(sessionStorage,e)};static temporary=this.temp;static last=this.permanent}return g}(window);
